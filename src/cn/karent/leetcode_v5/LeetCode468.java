package cn.karent.leetcode_v5;

import java.util.*;

import cn.karent.util.*;

/***********************************************
 * description: 验证IP地址
 * @author wan
 * @date 2021.06.19
 ***********************************************/
public class LeetCode468 {

    private int[][] transTable = 	{
            // 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17
            { 1, 2, 3, 4, 4, 4, 4, 4, 4, 4,15,15,15,15,15,15,99,99,99},
            {16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16, 0,13,99},
            { 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,16,16,16,16,16,16, 0,13,99},
            { 6, 6, 6, 6, 6, 7, 8, 8, 8, 8,16,16,16,16,16,16, 0,13,99},
            { 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,16,16,16,16,16,16, 0,13,99},
            {10,10,10,10,10,10,10,10,10,10,17,17,17,17,17,17, 0,13,99},
            {11,11,11,11,11,11,11,11,11,11,17,17,17,17,17,17, 0,13,99},
            {12,12,12,12,12,12,17,17,17,17,17,17,17,17,17,17, 0,13,99},
            {17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17, 0,13,99},
            {17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17, 0,13,99},
            {18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18, 0,13,99},
            {18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18, 0,13,99},
            {18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18, 0,13,99},
            {14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,99,99,99},
            {16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,99,13,99},
            {16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,99,13,99},
            {17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,99,13,99},
            {18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,99,13,99},
            {99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,13,99}
    };

    private int get(char ch) {
        if( ch >= '0' && ch <= '9') return ch - '0';
        else if( ch == 'a' || ch == 'A') return 10;
        else if( ch == 'b' || ch == 'B') return 11;
        else if( ch == 'c' || ch == 'C') return 12;
        else if( ch == 'd' || ch == 'D') return 13;
        else if( ch == 'e' || ch == 'E') return 14;
        else if( ch == 'f' || ch == 'F') return 15;
        else if( ch == '.') return 16;
        else if( ch == ':') return 17;
        else return 18;
    }

    public String validIPAddress(String IP) {
        int state = 0;
        int cnt = 0;
        for (int i = 0; i < IP.length() && state != 99; i++) {
            char ch = IP.charAt(i);
            state = transTable[state][get(ch)];
            if( state == 0 || state == 13) cnt++;
        }
        if( state == 99) return "Neither";
        else if( cnt == 3 && state <= 12 && state != 0) return "IPv4";
        else if( cnt == 7 && state != 13) return "IPv6";
        return "Neither";
    }

    public static void main(String[] args) {
        LeetCode468 lc = new LeetCode468();
//        String s = "172.16.254.1";
//        String s = "2001:0db8:85a3:0:0:8A2E:0370:7334";
//        String s = "2001:0db8:85a3:0000:0:8A2E:0370:733a";
//        String s = "1.1.1.01";
//        String s = "2001:0db8:85a3:00000:0:8A2E:0370:7334";
//        String s = "192.0.0.1";
        String s = "1.0.1.";
        String ret = lc.validIPAddress(s);
        System.out.println(ret);
    }

}
